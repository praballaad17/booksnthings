(this.webpackJsonpinstagram=this.webpackJsonpinstagram||[]).push([[8],{100:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),c=n.n(r),a=n(98),s=n(10),o=n(24),i=n(0),u=n(95);function l(e,t){var n=Object(i.useState)(!0),r=Object(o.a)(n,2),l=r[0],j=r[1],d=Object(i.useState)(!1),b=Object(o.a)(d,2),f=b[0],p=b[1],h=Object(i.useState)([]),O=Object(o.a)(h,2),m=O[0],x=O[1],v=Object(i.useState)(!1),_=Object(o.a)(v,2),g=_[0],w=_[1];return Object(i.useEffect)(Object(s.a)(c.a.mark((function n(){var r,o;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=function(){return(o=Object(s.a)(c.a.mark((function n(){var r,s,o;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((null===e||void 0===e||null===(r=e.following)||void 0===r?void 0:r.length)>0)){n.next=15;break}return n.prev=1,n.next=4,Object(u.b)(e._id,t,5);case 4:s=n.sent,o=s.results.sort((function(e,t){var n=new Date(e.date);return new Date(t.date)-n})),x((function(e){return[].concat(Object(a.a)(e),Object(a.a)(o))})),w(s.results.length>0),j(!1),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(1),p(!0),console.log(n.t0);case 15:case"end":return n.stop()}}),n,null,[[1,11]])})))).apply(this,arguments)},r=function(){return o.apply(this,arguments)},j(!0),p(!1),r();case 5:case"end":return n.stop()}}),n)}))),[null===e||void 0===e?void 0:e.userId,null===e||void 0===e?void 0:e.following,t]),{posts:m,loading:l,error:f,hasMore:g,setPosts:x}}},101:function(e,t,n){"use strict";var r=n(0),c=Object(r.createContext)(null);t.a=c},105:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n(5),c=n.n(r),a=n(10),s=n(24),o=n(0),i=n(94),u=n(93),l=n(16),j=n(96),d=n(95),b=n(98),f=n(25),p=n.n(f),h=n(2),O=n(99),m=(n(100),n(13),n(101)),x=n(3);function v(e){var t=e.open,n=e.content,r=e.onClose,i=(e.setProfile,e.photosCollection),u=Object(o.useState)(),j=Object(s.a)(u,2),f=(j[0],j[1],Object(o.useContext)(O.a).user),v=Object(o.useContext)(m.a),_=v.posts,g=v.setPosts,w=Object(h.h)().pathname;if(!t)return null;var N=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return p.a.createPortal(Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"modal-layout",onClick:r}),Object(x.jsx)("div",{className:"modal-box",children:Object(x.jsxs)("ul",{className:"modal-box__list",children:[Object(x.jsx)("li",{className:"modal-box__item",children:Object(x.jsx)(l.b,{target:"_blanck",to:"/user/".concat(null===n||void 0===n?void 0:n.author),children:"Share"})}),n.author!=f.username&&Object(x.jsx)("li",{className:"modal-box__item u-text-red-bold",onClick:N,children:"Unfollow"}),n.author==f.username&&Object(x.jsx)("li",{className:"modal-box__item u-text-red-bold",onClick:function(){g("/"==w?_.filter((function(e){return e._id!=n._id})):{photosCollection:i.filter((function(e){return e._id!=n._id}))}),Object(d.a)(n._id).then((function(){})).catch((function(e){alert("Error while deleting the Post, generally check your internet"),console.log(e,n),g("/"==w?function(e){return[].concat(Object(b.a)(e),[n])}:{photosCollection:i.push(n)})}))},children:"Delete Post"}),n.author!=f.username&&Object(x.jsx)("li",{className:"modal-box__item u-text-red-bold",onClick:function(){localStorage.setItem("dontLikePost",JSON.stringify({postId:n._id,author:n.author})),g(_.filter((function(e){return e._id!=n._id}))),r()},children:"I don't link this Post"}),Object(x.jsx)("li",{className:"modal-box__item",onClick:r,children:"Cancel"})]})})]}),document.getElementById("modal"))}function _(e){var t=e.username,n=e.profileImg,r=e.content,c=e.setProfile,a=e.photosCollection,d=Object(o.useState)(!1),b=Object(s.a)(d,2),f=b[0],p=b[1];return Object(x.jsxs)("div",{className:"post__header",children:[Object(x.jsxs)(l.b,{to:"/user/".concat(t),className:"flex items-center",children:[Object(x.jsx)("img",{className:"post__header--img",src:n||j.a,alt:"".concat(t," profile picture")}),Object(x.jsx)("p",{className:"font-bold",children:t})]}),Object(x.jsx)("div",{onClick:function(){return p(!0)},children:Object(x.jsx)(u.a,{icon:i.h})}),Object(x.jsx)(v,{content:r,open:f,onClose:function(){return p(!1)},setProfile:c,photosCollection:a})]})}function g(e){var t=e.files,n=e.caption,r=Object(o.useState)(0),c=Object(s.a)(r,2),a=c[0],l=c[1];return Object(x.jsx)("div",{className:"image-slider",children:Object(x.jsxs)("div",{className:"image-slider__box",children:[Object(x.jsx)("img",{src:t[a],alt:n}),Object(x.jsx)(x.Fragment,{children:a<t.length-1&&Object(x.jsx)("button",{className:"image-slider__btn image-slider__btn-inc",onClick:function(){if(a==t.length-1)return null;l(a+1)},children:Object(x.jsx)(u.a,{icon:i.b})})}),0!==a&&Object(x.jsx)("button",{className:"image-slider__btn image-slider__btn-dec",onClick:function(){if(0==a)return null;l(a-1)},children:Object(x.jsx)(u.a,{icon:i.a})})]})})}n(17);function w(e){var t=e.caption,n=e.username,r=Object(o.useState)(""),c=Object(s.a)(r,2),a=c[0],i=c[1];return Object(o.useEffect)((function(){i(t.replace("\n","\r"))}),[t]),Object(x.jsxs)("div",{className:"post__footer",children:[Object(x.jsx)("span",{className:"post__footer--name",children:n}),Object(x.jsx)("span",{className:"post__footer--caption",children:a})]})}n(124);var N=n(92);function k(e){var t=e.content,n=e.postref,r=e.setProfile,i=e.photosCollection,u=(Object(o.useRef)(null),Object(o.useState)()),l=Object(s.a)(u,2),j=l[0],d=l[1],b=t.files,f=t.caption,p=t.author;return Object(o.useEffect)(Object(a.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(N.b)(p);case 2:t=e.sent,n=t.displayImg,d(n.profileImg);case 5:case"end":return e.stop()}}),e)}))),[]),Object(x.jsxs)("div",{ref:n,className:"post",children:[Object(x.jsx)(_,{content:t,username:t.author,profileImg:j,setProfile:r,photosCollection:i}),Object(x.jsx)(g,{files:b,caption:t.author}),Object(x.jsx)(w,{caption:f,username:p})]})}},116:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var r=n(24),c=n(94),a=n(93),s=n(0),o=n(104),i=n.n(o),u=n(101),l=n(99),j=n(100),d=n(108),b=n(105),f=n(3);function p(){var e=Object(s.useContext)(l.a).user,t=Object(s.useState)(1),n=Object(r.a)(t,2),o=n[0],p=n[1],h=Object(s.useState)(!1),O=Object(r.a)(h,2),m=O[0],x=O[1],v=Object(j.a)(e,o),_=v.posts,g=v.loading,w=v.hasMore,N=v.error,k=v.setPosts,C=Object(s.useRef)(),P=Object(s.useCallback)((function(e){g||(C.current&&C.current.disconnect(),C.current=new IntersectionObserver((function(e){e[0].isIntersecting&&w&&p((function(e){return e+1}))})),e&&C.current.observe(e))}),[g,w]);return Object(f.jsx)(u.a.Provider,{value:{user:e,posts:_,setPosts:k},children:Object(f.jsxs)("div",{className:"container col-span-2",children:[Object(f.jsxs)("div",{className:"timeline__head",children:[!m&&Object(f.jsx)("h3",{className:"heading-main",children:"Home"}),m&&Object(f.jsxs)("div",{className:"timeline__head--search",children:[Object(f.jsx)(a.a,{icon:c.a,onClick:function(){x(!1)}}),Object(f.jsx)(d.a,{})]}),Object(f.jsx)("div",{className:"timeline__head--searchbtn",children:Object(f.jsx)(a.a,{icon:c.p,onClick:function(){return x(!0)}})})]}),_?_.map((function(e,t){return _.length===t+1?Object(f.jsx)(b.a,{postref:P,content:e},null===e||void 0===e?void 0:e._id):Object(f.jsx)(b.a,{content:e},null===e||void 0===e?void 0:e._id)})):Object(f.jsx)(i.a,{count:4,width:640,height:500,className:"mb-5"}),Object(f.jsx)("div",{children:g&&Object(f.jsx)(i.a,{count:4,width:640,height:500,className:"mb-5"})}),Object(f.jsx)("div",{children:N&&"Error"})]})})}},95:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return b}));var r=n(5),c=n.n(r),a=n(10),s=n(11),o=n.n(s),i=n(18),u=i.a+"/post",l=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r,a){var s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("".concat(u,"/").concat(r),{files:t,caption:n},a);case 3:return s=e.sent,i=s.data,e.abrupt("return",{data:i});case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0.response.data.error);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r,c){return e.apply(this,arguments)}}(),j=function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.get("".concat(u,"/user-posts/").concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.response.data.error);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(c.a.mark((function e(t,n,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.get("".concat(u,"/all-posts/").concat(t),{params:{page:n,limit:r}});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0.response.data.error);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.delete("".concat(u,"/delete/").concat(t));case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0.response.data.error);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=8.684ad80d.chunk.js.map